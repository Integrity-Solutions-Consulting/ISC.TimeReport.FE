<h2 mat-dialog-title>{{ data.isEdit ? 'Editar actividad' : 'Agregar actividad' }}</h2>

<mat-dialog-content>
  <div class="form-container">

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Tipo Actividad</mat-label>
      <mat-select [(ngModel)]="event.activityTypeID" required name="activityType">
        @for (type of activityTypes; track type.id) {
          <mat-option [value]="type.id">{{type.value}}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Proyecto</mat-label>
      <mat-select [(ngModel)]="event.projectId" required name="project">
        <mat-option *ngFor="let project of projects" [value]="project.id">
          {{project.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Descripción</mat-label>
      <textarea matInput [(ngModel)]="event.activityDescription" rows="3" required name="description"></textarea>
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Detalle de la actividad</mat-label>
      <textarea matInput [(ngModel)]="event.details" rows="3" name="details"></textarea>
    </mat-form-field>

    <div class="duration-container">
      <span>Duración:</span>
      <mat-slide-toggle [(ngModel)]="isFullDay" (change)="onDurationChange()" color="primary" name="durationToggle">
        {{isFullDay ? 'Día completo' : 'Medio día'}}
      </mat-slide-toggle>
    </div>

    <div class="row">
      <mat-form-field appearance="outline" class="half-width">
        <mat-label>Fecha actividad</mat-label>
        <input matInput [matDatepicker]="activityDatePicker" [(ngModel)]="event.activityDate" required name="activityDate">
        <mat-datepicker-toggle matSuffix [for]="activityDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #activityDatePicker></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="!isFullDay">
        <mat-label>Número de horas</mat-label>
        <input matInput type="number" [(ngModel)]="event.hours" name="hours" min="1" max="8" [required]="!isFullDay" (ngModelChange)="validateHours()">
        <mat-error *ngIf="!isFullDay">
          Horas inválidas (debe ser entre 1 y 8).
        </mat-error>
      </mat-form-field>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-raised-button (click)="onCancel()">Cancelar</button>
  <button mat-raised-button style="background-color: var(--itg-primary); color: var(--itg-bg)" [mat-dialog-close]="preparePayload()" [disabled]="!isFormValid()">
    {{ data.isEdit ? 'Editar' : 'Agregar' }}
  </button>
</mat-dialog-actions>
