<h2 mat-dialog-title>Cargar Archivo Excel</h2>

<mat-dialog-content>
  <div class="download-model-container">
    <button mat-stroked-button
            color="primary"
            (click)="downloadExcelModel()"
            class="download-button"
            [disabled]="isLoading || isUploading">
      <mat-icon>download</mat-icon>
      Descargar modelo de Excel
      <mat-spinner diameter="20" *ngIf="isLoading" class="spinner"></mat-spinner>
    </button>
  </div>
  <div class="upload-container"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        (drop)="onDrop($event)"
        [class.drag-over]="isDragOver"
        [class.invalid-file]="showInvalidFileError"
        (click)="fileInput.click()">

    <mat-icon class="upload-icon">cloud_upload</mat-icon>

    <p class="upload-text">
      Arrastra tu archivo Excel aquí o haz clic para seleccionarlo
    </p>

    <p class="file-hint">
      Formatos soportados: .xlsx, .xls
    </p>

    <input #fileInput
            type="file"
            hidden
            (change)="onFileSelected($event)"
            accept=".xlsx,.xls">

    <div *ngIf="selectedFile" class="file-info">
      <mat-icon>description</mat-icon>
      <span class="file-name">{{ selectedFile.name }}</span>
      <span class="file-size">({{ getFileSize(selectedFile.size) }})</span>
    </div>

    <div *ngIf="showInvalidFileError" class="error-message">
      <mat-icon>error_outline</mat-icon>
      <span>Formato de archivo no válido. Solo se permiten .xlsx y .xls</span>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()" [disabled]="isUploading">Cancelar</button>
  <button mat-raised-button
          style="background-color: var(--itg-primary); color: var(--itg-bg)"
          (click)="onUpload()"
          [disabled]="!selectedFile || isLoading || isUploading">
    <mat-spinner diameter="20" *ngIf="isUploading" class="spinner"></mat-spinner>
    {{ isUploading ? 'Cargando...' : 'Cargar Archivo' }}
  </button>
</mat-dialog-actions>
