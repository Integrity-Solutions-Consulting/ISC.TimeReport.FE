<div class="filter-card">
  <div class="filter-row">

    <!-- CLIENTE AUTOCOMPLETE -->
    <mat-form-field appearance="outline" class="filter-item">
      <mat-label>Cliente</mat-label>

      <input
        matInput
        placeholder="Buscar cliente"
        [formControl]="clientFilter"
        [matAutocomplete]="autoClient"
      />

      <mat-autocomplete #autoClient="matAutocomplete">
        <mat-option value="Todos">Todos</mat-option>
        <mat-option *ngFor="let c of filteredClients" [value]="c">
          <mat-icon class="option-icon">business</mat-icon>
          {{ c }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <!-- LÍDER AUTOCOMPLETE -->
    <mat-form-field appearance="outline" class="filter-item">
      <mat-label>Líder</mat-label>

      <input
        matInput
        placeholder="Buscar líder"
        [formControl]="leaderFilter"
        [matAutocomplete]="autoLeader"
      />

      <mat-autocomplete #autoLeader="matAutocomplete">
        <mat-option value="Todos">Todos</mat-option>
        <mat-option *ngFor="let l of filteredLeaders" [value]="l">
          <mat-icon class="option-icon">person</mat-icon>
          {{ l }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <!-- FECHA INICIO -->
    <mat-form-field appearance="outline" class="filter-item">
      <mat-label>Fecha Inicio</mat-label>
      <input
        matInput
        [matDatepicker]="startPicker"
        [formControl]="startDateFilter"
        (dateChange)="validateDates()"
      />
      <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
      <mat-datepicker #startPicker></mat-datepicker>
    </mat-form-field>

    <!-- FECHA FIN -->
    <mat-form-field appearance="outline" class="filter-item">
      <mat-label>Fecha Fin</mat-label>
      <input
        matInput
        [matDatepicker]="endPicker"
        [formControl]="endDateFilter"
        (dateChange)="validateDates()"
      />
      <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
      <mat-datepicker #endPicker></mat-datepicker>
    </mat-form-field>

    <!-- BOTONES -->
    <div class="export-btn-wrapper">
      <button mat-flat-button color="primary" (click)="exportToExcel()">
        <mat-icon>download</mat-icon>
        Exportar
      </button>

      <button mat-button color="primary" class="clear-btn" (click)="clearFilters()">
        <mat-icon>filter_alt_off</mat-icon>
        Limpiar filtros
      </button>
    </div>

  </div>
</div>

<!-- WRAPPER de la tabla -->
<div class="table-wrapper">

  <!-- LOADER sobre la tabla -->
  <div class="table-loading-overlay" *ngIf="loading">
    <mat-spinner diameter="60"></mat-spinner>
    <p>Cargando datos...</p>
  </div>

  <!-- TABLA REAL -->
  <table mat-table [dataSource]="dataSource" class="mat-elevation-z2 full-table">

    <ng-container matColumnDef="client">
      <th mat-header-cell *matHeaderCellDef>Cliente</th>
      <td mat-cell *matCellDef="let row">{{ row.client }}</td>
    </ng-container>

    <ng-container matColumnDef="leader">
      <th mat-header-cell *matHeaderCellDef>Líder</th>
      <td mat-cell *matCellDef="let row">{{ row.leader }}</td>
    </ng-container>

    <ng-container matColumnDef="resource">
      <th mat-header-cell *matHeaderCellDef>Recurso</th>
      <td mat-cell *matCellDef="let row">{{ row.resource }}</td>
    </ng-container>

    <ng-container matColumnDef="profile">
      <th mat-header-cell *matHeaderCellDef>Cargo</th>
      <td mat-cell *matCellDef="let row">{{ row.profile }}</td>
    </ng-container>

    <ng-container matColumnDef="start">
      <th mat-header-cell *matHeaderCellDef>Inicio</th>
      <td mat-cell *matCellDef="let row">{{ row.start | date : "dd/MM/yyyy" }}</td>
    </ng-container>

    <ng-container matColumnDef="end">
      <th mat-header-cell *matHeaderCellDef>Fin</th>
      <td mat-cell *matCellDef="let row">{{ row.end | date : "dd/MM/yyyy" }}</td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>

  </table>

  <mat-paginator [pageSize]="10"></mat-paginator>
</div>
